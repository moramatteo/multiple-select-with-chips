function show_options_list(e){$(`[select_name=${e}] > .options-list`).removeClass("hide"),select_name=e}function add_chip(e,t,s,l){try{if(l||(l=select_name),""!=e){var n=t[0].firstChild.nextSibling.innerText;$(e).addClass("select")}else{n=s;data_validator(l,n,"enter")}$(`[select_name=${l}] .chips`).append(`\n    <div value="${s}">\n      <span>${n}</span>\n      <span class="delete-chip material-icons" value="${s}" select_name="${l}" onclick="${delete_chip_function}">close</span>\n    </div>\n  `),$(e).attr("onclick",`${delete_chip_function}`),set_input_with()}catch(e){alert(e)}}function delete_chip(e,t){$(`[select_name=${t}] .chips > div[value="${e}"]`).remove(),$(`[select_name=${t}] .option[value="${e}"]`).removeClass("select").attr("onclick",add_chip_function),set_input_with()}function onKeyPressed(e){var t=e.key;if("Enter"==t&&1==$(`[select_name=${select_name}]  .text-input`).is(":focus")&&1==$(`[select_name=${select_name}]  .text-input`).hasClass("add_personal_chip")){var s=$(`.text-input[select_name=${select_name}]`).val();""!=s&&($(".text-input").val("").blur(),add_chip("","",s),$(`[select_name=${select_name}] .option`).removeClass("hide"),$(`[select_name=${select_name}] .options-list`).addClass("hide"))}}function options_filter(e){if(""==e)$(`[select_name=${select_name}] .option`).removeClass("hide");else for(var t=$(`[select_name=${select_name}] .options-list`).children().length,s=1;s<t+1;s++)-1==$(`[select_name=${select_name}] .option:nth-child(${s}) > .option-text`).html().toLowerCase().indexOf(e.toLowerCase())?$(`[select_name=${select_name}] .option:nth-child(${s})`).addClass("hide"):$(`[select_name=${select_name}] .option:nth-child(${s})`).removeClass("hide");$(`[select_name=${select_name}] .option`).removeClass("top-border bottom-border"),$(`[select_name=${select_name}] .option:not(.hide)`).first().addClass("top-border"),$(`[select_name=${select_name}] .option:not(.hide)`).last().addClass("bottom-border")}function select_all(e){e||(e=select_name);for(var t=$(`[select_name=${e}] .options-list`).children().length,s=1;s<t+1;s++){var l=`[select_name=${e}] .options-list > div:nth-child(${s})`;1!=$(l).hasClass("select")&&add_chip($(l),$(l).first(),$(l).attr("value"),e)}}function deselect_all(e,t){t||(t=select_name);for(var s=$(`[select_name=${t}] .options-list`).children().length,l=1;l<s+1;l++){var n=`[select_name=${t}] .options-list > div:nth-child(${l})`;0!=$(n).hasClass("select")&&($(n).removeClass("select"),delete_chip($(n).attr("value"),t))}"forced"==e&&$(`[select_name=${t}] .chips > div`).remove()}function data_validator(e,t,s){var l=[];if("enter"==s){for(var n=$(`[select_name=${e}] .chips`).children().length,a=1;a<n+1;a++){var i=`[select_name=${e}] .chips > div:nth-child(${a})`,c=$(i).attr("value");if(l.push(c),l.includes(t))throw"valore già selezionato"}var o=$(`[select_name=${e}] .options-list`).children().length;for(a=1;a<o+1;a++){i=`[select_name=${e}] .options-list > div:nth-child(${a})`,c=$(i).attr("value");if(l.push(c),l.includes(t))throw"c'è già una opzione con questo valore"}}if("constructor"==s||"replace"==s)for(a=0;a<t.length;a++){if(null==t[a].text||""==t[a].text)throw`Non è stato impostato nessun testo per il valore "${t[a].value}"`;if(null==t[a].value||""==t[a].value)throw`Non è stato impostato nessun valore per il testo "${t[a].text}"`;if(l.includes(t[a].value))throw"Ci sono dei valori duplicati";l.push(t[a].value)}if("add"==s){data_validator(e,t,"replace");for(n=$(`[select_name=${e}] .chips`).children().length,a=1;a<n+1;a++){i=`[select_name=${e}] .chips > div:nth-child(${a})`,c=$(i).attr("value");l.push(c)}for(o=$(`[select_name=${e}] .options-list`).children().length,a=1;a<o+1;a++){i=`[select_name=${e}] .options-list > div:nth-child(${a})`,c=$(i).attr("value");l.push(c)}for(a=0;a<t.length;a++)if(l.includes(t[a].value))throw"Ci sono dei valori duplicati"}}function set_input_with(){for(var e=$("div[select_name]").length,t=0;t<e;t++){var s=$(`div[select_name]:eq(${t}) .chips`).width(),l=$(`div[select_name]:eq(${t}) .selected`).width(),n=l-s;n>100?$(`div[select_name]:eq(${t}) .text-input`).css("width",n):$(`div[select_name]:eq(${t}) .text-input`).css("width","100px")}}var select_name,old_select_name,delete_chip_function="delete_chip($(this).attr('value'), $(this).attr('select_name'))",add_chip_function="add_chip(this, $(this).first(), $(this).attr('value'))";document.onclick=function(e){var t=!0,s=select_name;old_select_name!=s&&null!=old_select_name&&$(`[select_name="${old_select_name}"] .options-list`).addClass("hide");for(var l=0;l<e.path.length;l++)if(null!=e.path[l].className&&e.path[l].className.includes("multiple-select-chip")){t=!1,old_select_name=s;break}t&&$(`[select_name="${s}"] .options-list`).addClass("hide")},document.addEventListener("keydown",onKeyPressed),$(window).resize(function(){set_input_with()});class select{constructor(e,t,s){this.select_name=e,s||(s={});try{null==s.placeholder&&(s.placeholder="Cerca"),data_validator(this.select_name,t,"constructor");var l=this.create_chips(t),n=`<div class="selected">\n      <div class="chips">\n        ${l}\n      </div>\n      <input type="text" class="text-input add_personal_chip" placeholder="${s.placeholder}"\n      onfocus="show_options_list($(this).attr('select_name'))" select_name="${e}"\n      onkeyup="options_filter(this.value)">\n    </div>\n    <div class="options-list hide">\n      ${this.create_options(t)}\n    </div>`;$(`[select_name=${e}]`).append(n),0==s.add_personal_chip&&$(`[select_name=${e}] .text-input`).removeClass("add_personal_chip"),0==s.autocomplete&&$(`[select_name=${e}] .text-input`).removeAttr("onkeyup"),set_input_with()}catch(t){alert(`errore nel selettore chiamato "${this.select_name}"\n${t}`),$(`[select_name=${e}]`).append("errore nell'inserimento delle opzioni")}}create_chips(e){for(var t="",s=0;s<e.length;s++)1==e[s].select&&(t+=`<div value="${e[s].value}">\n          <span>${e[s].text}</span>\n          <span class="delete-chip material-icons" value="${e[s].value}" select_name="${this.select_name}" onclick="${delete_chip_function}">close</span>\n        </div>`);return t}create_options(e){for(var t="",s=0;s<e.length;s++)1==e[s].select?t+=`<div class="option select" value="${e[s].value}" select_name="${this.select_name}" onclick="${delete_chip_function}">`:t+=`<div class="option" value="${e[s].value}" select_name="${this.select_name}" onclick="${add_chip_function}">`,t+=`\n          <div class="option-text">${e[s].text}</div>\n          <div class="check-mark">\n            <span class="material-icons-outlined">close</span>\n          </div>\n        </div>`;return t}new_data(e,t){t||(t="replace");try{data_validator(this.select_name,e,t);var s=this.create_chips(e),l=this.create_options(e);"replace"==t&&($(`[select_name=${this.select_name}] .options-list`).replaceWith('<div class="options-list hide">'+l+"</div>"),$(`[select_name=${this.select_name}] .chips > div`).remove(),$(`[select_name=${this.select_name}] .chips`).append(` ${s} `)),"add"==t&&($(`[select_name=${this.select_name}] .options-list`).append(l),$(`[select_name=${this.select_name}] .chips`).append(` ${s} `))}catch(e){alert(`errore nel selettore chiamato "${this.select_name}"\n${e}`),$(`[select_name=${this.select_name}]`).replaceWith("errore nell'inserimento delle opzioni")}}get_value(){for(var e={all:this.check_all_selected(),names:[],values:[]},t=$(`[select_name=${this.select_name}] .chips`).children().length,s=1;s<t+1;s++){var l=$(`[select_name=${this.select_name}] .chips > div:nth-child(${s})`).attr("value");e.values.push(l);var n=$(`[select_name=${this.select_name}] .chips > div:nth-child(${s}) > span:nth-child(2)`).html();e.names.push(n)}return e}check_all_selected(){for(var e=!0,t=$(`[select_name=${this.select_name}] .options-list`).children().length,s=1;s<t+1;s++){var l=`[select_name=${this.select_name}] .options-list > div:nth-child(${s})`;if(0==$(l).hasClass("select")){e=!1;break}}return e}select_all(){select_all(this.select_name)}deselect_all(e){deselect_all(e,this.select_name)}}